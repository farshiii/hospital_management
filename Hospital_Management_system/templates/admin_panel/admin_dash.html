<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
    body{
        background-color:#E8E9EB;
        margin:0;
        padding:0;
        border:0;
    }
    .nav-content-container-dupe{
        height:100vh;
        width:300px;
        background-color:E8E9EB;
        text-decoration:none;
        border-top-right-radius:50px;
        border-bottom-right-radius:50px;
        padding-bottom:50px;
        box-shadow: 0 4px 6px 6px rgba(0, 0, 0, 0.1);

    }
    .nav-content-container{
        position: fixed;
        z-index: 999;
        height:100vh;
        width:300px;
        background-color:white;
        text-decoration:none;
        border-top-right-radius:50px;
        border-bottom-right-radius:50px;
        padding-bottom:50px;
        box-shadow: 0 4px 6px 6px rgba(0, 0, 0, 0.1);
    }
    .nav-content{
        margin-bottom:30px;
        margin-right:20px;
        margin-left:20px;
        width:260px;
        max-height:50px;
        background-color:#333;
        border-radius:8px;
        text-align:center;
        box-shadow: 0 8px 10px rgba(0, 0, 0, 0.1);
    }
    .nav-content h4{
        font-size:16px;
        line-height:50px;
        text-decoration:none;
        }
    .nav-content a {
        text-decoration:none;
        color:white;
    }

    .main-section{
        width:100%;
    }
    .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .section {
            background-color: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            padding: 20px;
            width:1000px;
            margin-left:100px;
            margin-right:100px;
            margin-top:50px;
        }

        .section h2 {
            margin-top: 0;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
        }

        .stat1 {
            background: #29C5F6;
            padding: 20px;
            width: calc(20% - 20px);
            text-align: center;
        }
        .stat {
            background: #77DD77;
            padding: 20px;
            width: calc(20% - 20px);
            text-align: center;
        }

        .stat1 h3 {
            margin-bottom: 10px;
            font-size:20px;
        }
        .stat h3 {
            margin-bottom: 10px;
            font-size:20px;
        }

        .stat p {
            font-size: 24px;
            font-weight: bold;
        }
        .stat1 p {
            font-size: 24px;
            font-weight: bold;
        }
        .charts{
            width:200px;

        }
        .chart-section{
            background-color: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            padding:50px;
            width:300px;
            margin-left:100px;
            margin-right:100px;
            margin-top:20px;
        }
        .chart-section1{
            background-color: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            padding:10px;
            width:600px;
            margin-right:100px;
            margin-top:20px;
        }
        .chart-section2{
            background-color: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            padding:50px;
            width:1000px;
            margin-left:100px;
            margin-right:100px;
            margin-top:20px;
        }

        .charts1 img{
            width:450px
        }
        .chart-container{
        }
        .nav-main-container img{
            display:block;
            width:200px;
            margin:50px;
        }

</style>
</head>
<body>
    <div class="nav-container d-flex flex-row justify-content-start">
            <div class="nav-content-container-dupe d-flex flex-column justify-content-end">
            </div>
            <div class="nav-content-container d-flex flex-column justify-content-end">
                <div class="nav-main-container">
                    <img src="{% static 'images/logo.png' %}" alt="">
                </div>
                <div class="nav-main-container">
                    <div class="nav-content"><a href="{% url 'Appointment_dash' %}" ><h4>Appointment Dash</h4></a></div>
                    <div class="nav-content"><a href="{% url 'Profit_dash' %}"><h4>Profit Dash</h4></a></div>
<!--                    <div class="nav-content"><a href="{% url 'admin_staff_page' %}"><h4>Staff</h4></a></div>-->
                    <div class="nav-content"><a href="adddoctor"><h4>Add Doctor</h4></a></div>
                    <div class="nav-content"><a href="adddepartment"><h4>Add Department</h4></a></div>
                </div>
            </div>
            <div class="main-section">
            <div class="section">
            <div class="stats">
                <div class="stat1">
                    <h3>Total Appointments</h3>
                    <p>{{ total_appointments }}</p>
                </div>
                <div class="stat">
                    <h3>Completed Appointments</h3>
                    <p>{{ completed_appointments }}</p>
                </div>
                <div class="stat">
                    <h3>Total Income</h3>
                    <p>${{ total_income }}</p>
                </div>
                <div class="stat">
                    <h3>Paid Invoices</h3>
                    <p>{{ paid_invoices }}</p>
                </div>
            </div>
            </div>
                <div class="chart-container d-flex flex-row justify-content-start">
                <div class="chart-section">
            <div class="charts">
                <canvas id="appointmentsStatusChart"></canvas>
            </div>
                </div>
                <div class="chart-section1">
            <div class="charts1">
                <img src="data:image/png;base64,{{ data }}" />
            </div>
                </div>
            </div>
                <div class="chart-container2 d-flex flex-row justify-content-start">
                <div class="chart-section2">
<table class="table" >
  <thead>
    <tr>
      <th scope="col">#</th>
      <th scope="col">Name</th>
      <th scope="col">Phone</th>
      <th scope="col">Email</th>
      <th scope="col">Message</th>
    </tr>
  </thead>
  <tbody>
  {% for i in message %}
    <tr>
      <th scope="row">{{i.id}}</th>
      <td>{{i.name}}</td>
      <td>{{i.phone}}</td>
      <td>{{i.email}}</td>
      <td>{{i.message}}</td>
    </tr>
  {% endfor %}
  </tbody>
</table>
            </div>
    </div>
    </div>
<script>
        document.addEventListener('DOMContentLoaded', function () {
            var appointmentsByStatus = {{ appointments_by_status|safe }};

            var statusLabels = appointmentsByStatus.map(item => item.status);
            var statusCounts = appointmentsByStatus.map(item => item.count);

            var ctxStatus = document.getElementById('appointmentsStatusChart').getContext('2d');
            new Chart(ctxStatus, {
                type: 'pie',
                data: {
                    labels: statusLabels,
                    datasets: [{
                        label: 'Appointments by Status',
                        data: statusCounts,
                        backgroundColor: ['#ff6384', '#36a2eb', '#cc65fe', '#ffce56']
                    }]
                }
            });
        });
    </script>
</body>
</html>
